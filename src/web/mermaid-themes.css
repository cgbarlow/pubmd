/* Base variables that might be common or overridden */
:root {
    /* Default font, can be overridden by .mermaid-font-xxx */
    --mermaid-font-family-default: 'DejaVu Sans', sans-serif; 
    --mermaid-font-size-default: 16px;
}

/* Grey Theme */
.mermaid-theme-grey {
    --mermaid-font-family: var(--mermaid-font-family-default);
    --mermaid-font-size: var(--mermaid-font-size-default);
    --mermaid-text-color: #333333;
    --mermaid-node-text-color: #333333; /* Ensure nodes also use this */
    --mermaid-primary-text-color: #333333; /* Text on nodes */
    --mermaid-line-color: #888888;
    --mermaid-primary-color: #f4f4f4; /* Node background */
    --mermaid-primary-border-color: #888888;
    --mermaid-secondary-color: #dcdcdc;
    --mermaid-secondary-border-color: #777777;
    --mermaid-secondary-text-color: #333333;
    --mermaid-tertiary-color: #cecece;
    --mermaid-tertiary-border-color: #666666;
    --mermaid-tertiary-text-color: #333333;
    --mermaid-note-bkg-color: #f0f0f0;
    --mermaid-note-text-color: #333333;
    --mermaid-note-border-color: #aaaaaa;
    --mermaid-label-background-color: #e0e0e0; /* For labels on edges */
    --mermaid-label-text-color: #333333;
    --mermaid-error-background-color: #ffdddd;
    --mermaid-error-text-color: #d8000c;
    --mermaid-flowchart-arrowhead-color: #666666;
    --mermaid-cluster-background-color: rgba(200, 200, 200, 0.1);
    --mermaid-cluster-border-color: #bbbbbb;
}

/* Light Theme (GitHub Inspired) */
.mermaid-theme-light {
    --mermaid-font-family: var(--mermaid-font-family-default);
    --mermaid-font-size: var(--mermaid-font-size-default);

    /* From reference: .node text */
    --mermaid-text-color: #333333; 
    --mermaid-node-text-color: #333333; 
    --mermaid-primary-text-color: #333333; 

    /* From reference: .edgePath path */
    --mermaid-line-color: #999999; 
    --mermaid-flowchart-arrowhead-color: #999999; /* Match line color */

    /* From reference: .node rect */
    --mermaid-primary-color: #e8e8ff; /* Node background */
    --mermaid-primary-border-color: #cccccc; 
    
    /* From reference: .subgraph > rect */
    --mermaid-cluster-background-color: #fff4dd;
    --mermaid-cluster-border-color: #cccccc;

    /* Sensible defaults for other vars, can be refined */
    --mermaid-secondary-color: #d1e7ff; /* Lighter blue as secondary */
    --mermaid-secondary-border-color: #b3d7ff;
    --mermaid-secondary-text-color: #333333;
    
    --mermaid-tertiary-color: #f0f0f0; 
    --mermaid-tertiary-border-color: #cccccc;
    --mermaid-tertiary-text-color: #333333;

    --mermaid-note-bkg-color: #fff9e6; /* Light yellow for notes */
    --mermaid-note-text-color: #333333;
    --mermaid-note-border-color: #ffe0b3;

    --mermaid-label-background-color: #e8f5ff; 
    --mermaid-label-text-color: #333333; 

    --mermaid-error-background-color: #ffebee; /* Light red for errors */
    --mermaid-error-text-color: #c62828;
}

/* Dark Theme (GitHub Inspired) */
.mermaid-theme-dark {
    --mermaid-font-family: var(--mermaid-font-family-default);
    --mermaid-font-size: var(--mermaid-font-size-default);

    /* From reference: .node text */
    --mermaid-text-color: #dddddd;
    --mermaid-node-text-color: #dddddd;
    --mermaid-primary-text-color: #dddddd;

    /* From reference: .edgePath path */
    --mermaid-line-color: #777777;
    --mermaid-flowchart-arrowhead-color: #777777; /* Match line color */

    /* From reference: .node rect */
    --mermaid-primary-color: #1c1d1e; /* Node background */
    --mermaid-primary-border-color: #444444;

    /* From reference: .subgraph > rect */
    --mermaid-cluster-background-color: #242524;
    --mermaid-cluster-border-color: #555555;

    /* Sensible defaults for other vars, can be refined */
    --mermaid-secondary-color: #2a2f36; /* Darker blue/grey as secondary */
    --mermaid-secondary-border-color: #38414b;
    --mermaid-secondary-text-color: #dddddd;

    --mermaid-tertiary-color: #161a1e; 
    --mermaid-tertiary-border-color: #333333;
    --mermaid-tertiary-text-color: #dddddd;

    --mermaid-note-bkg-color: #2f2b1e; /* Dark yellow for notes */
    --mermaid-note-text-color: #dddddd;
    --mermaid-note-border-color: #5a523a;

    --mermaid-label-background-color: #1c2938; 
    --mermaid-label-text-color: #dddddd; 

    --mermaid-error-background-color: #3e1c1c; /* Dark red for errors */
    --mermaid-error-text-color: #ff8a80;
}

/* Direct overrides for text elements in dark theme for better preview consistency */
/* These rules apply when .mermaid-theme-dark is on a PARENT of the .mermaid div */
.mermaid-theme-dark .mermaid .node text,
.mermaid-theme-dark .mermaid .node > .label text, /* More specific for node labels */
.mermaid-theme-dark .mermaid .node tspan { /* tspan elements within text */
    fill: var(--mermaid-node-text-color, #dddddd) !important;
}

.mermaid-theme-dark .mermaid .cluster text,
.mermaid-theme-dark .mermaid .cluster > .label text { /* More specific for cluster labels */
    fill: var(--mermaid-text-color, #dddddd) !important;
}

.mermaid-theme-dark .mermaid .noteText,
.mermaid-theme-dark .mermaid .note > text { /* More specific for note text */
    fill: var(--mermaid-note-text-color, #dddddd) !important;
}

.mermaid-theme-dark .mermaid .edgeLabel text,
.mermaid-theme-dark .mermaid .edgeLabel span { /* For HTML content in edge labels */
    fill: var(--mermaid-label-text-color, #dddddd) !important; /* SVG text */
    color: var(--mermaid-label-text-color, #dddddd) !important; /* HTML text */
}

/* General text elements within the SVG, less specific, as a fallback */
.mermaid-theme-dark .mermaid svg text {
    fill: var(--mermaid-text-color, #dddddd);
}
.mermaid-theme-dark .mermaid svg tspan { /* Ensure tspans also inherit */
    fill: currentColor; /* Inherit from parent text element if not overridden */
}


/* Specific for flowchart labels if they are not covered by .edgeLabel or .node text */
.mermaid-theme-dark .mermaid .flowchart-label text,
.mermaid-theme-dark .mermaid .labelHost foreignObject div, /* For foreignObject labels */
.mermaid-theme-dark .mermaid .labelHost span { /* For HTML-based labels */
    fill: var(--mermaid-label-text-color, #dddddd) !important; 
    color: var(--mermaid-label-text-color, #dddddd) !important; 
}

/* Ensure actor text in sequence diagrams is also light */
.mermaid-theme-dark .mermaid .actor text,
.mermaid-theme-dark .mermaid .actor line { /* Actor symbol lines */
    fill: var(--mermaid-text-color, #dddddd) !important;
    stroke: var(--mermaid-text-color, #dddddd) !important; /* For lines of the actor symbol */
}
.mermaid-theme-dark .mermaid .actor > rect { /* Actor box */
     fill: var(--mermaid-primary-color, #1c1d1e) !important;
     stroke: var(--mermaid-primary-border-color, #444444) !important;
}


/* Ensure task text in gantt diagrams is also light */
.mermaid-theme-dark .mermaid .taskText,
.mermaid-theme-dark .mermaid .taskTextOutside {
    fill: var(--mermaid-text-color, #dddddd) !important;
}
.mermaid-theme-dark .mermaid .task {
    stroke: var(--mermaid-primary-border-color, #444444) !important;
    fill: var(--mermaid-primary-color, #1c1d1e) !important;
}
.mermaid-theme-dark .mermaid .task.done {
    fill: var(--mermaid-secondary-color, #2a2f36) !important;
}
.mermaid-theme-dark .mermaid .task.active {
     fill: var(--mermaid-tertiary-color, #161a1e) !important;
}


/* Font Family Overrides for Mermaid diagrams */
/* Apply these classes to a container wrapping the .mermaid div */
.mermaid-font-sans {
    --mermaid-font-family: 'DejaVu Sans', sans-serif !important;
}

.mermaid-font-serif {
    --mermaid-font-family: 'DejaVu Serif', serif !important;
}

/* Ensure the variables are applied to the Mermaid SVG elements */
/* This might be needed if the classes are on a parent not directly read by mermaid for vars */
.mermaid-theme-grey .mermaid svg, .mermaid-theme-grey .mermaid {
    /* All variables from .mermaid-theme-grey will apply here */
}
.mermaid-theme-light .mermaid svg, .mermaid-theme-light .mermaid {
    /* All variables from .mermaid-theme-light will apply here */
}
.mermaid-theme-dark .mermaid svg, .mermaid-theme-dark .mermaid {
    /* All variables from .mermaid-theme-dark will apply here */
}

.mermaid-font-sans .mermaid svg, .mermaid-font-sans .mermaid {
    font-family: var(--mermaid-font-family);
}
.mermaid-font-serif .mermaid svg, .mermaid-font-serif .mermaid {
    font-family: var(--mermaid-font-family);
}